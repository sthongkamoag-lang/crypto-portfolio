{"ast":null,"code":"import*as XLSX from'xlsx';export const exportToExcel=trades=>{try{const data=trades.map(trade=>({'ID':trade.id,'วันที่':trade.date,'ประเภท':trade.type,'คู่เทรด':trade.pair,'ราคา':trade.price,'จำนวน':trade.amount,'มูลค่ารวม':trade.totalValue,'ค่าธรรมเนียม':trade.fee,'กำไร/ขาดทุน':trade.profitLoss,'สถานะ':trade.status,'เงินสดคงเหลือ':trade.cashBalance,'เงินทุนสุทธิ':trade.capitalBalance,'กำไรสะสม':trade.profitBalance,'มูลค่าพอร์ต':trade.portfolioValue,'หมายเหตุ':trade.note}));const ws=XLSX.utils.json_to_sheet(data);const wb=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wb,ws,'Trade Ledger');const wscols=[{wch:5},{wch:12},{wch:10},{wch:12},{wch:12},{wch:15},{wch:15},{wch:12},{wch:15},{wch:10},{wch:15},{wch:15},{wch:15},{wch:15},{wch:20}];ws['!cols']=wscols;const fileName=\"Crypto_Portfolio_\".concat(new Date().toISOString().split('T')[0],\".xlsx\");XLSX.writeFile(wb,fileName);alert('✅ Export Excel สำเร็จ!');}catch(error){console.error('Export Excel Error:',error);alert('❌ เกิดข้อผิดพลาดในการ Export Excel');}};export const exportToCSV=trades=>{try{const headers=['ID','วันที่','ประเภท','คู่เทรด','ราคา','จำนวน','มูลค่ารวม','ค่าธรรมเนียม','กำไร/ขาดทุน','สถานะ','เงินสดคงเหลือ','เงินทุนสุทธิ','กำไรสะสม','มูลค่าพอร์ต','หมายเหตุ'];const rows=trades.map(trade=>[trade.id,trade.date,trade.type,trade.pair,trade.price,trade.amount,trade.totalValue,trade.fee,trade.profitLoss,trade.status,trade.cashBalance,trade.capitalBalance,trade.profitBalance,trade.portfolioValue,trade.note]);const csvContent=[headers.join(','),...rows.map(row=>row.map(cell=>\"\\\"\".concat(cell,\"\\\"\")).join(','))].join('\\n');const blob=new Blob(['\\uFEFF'+csvContent],{type:'text/csv;charset=utf-8;'});const link=document.createElement('a');const url=URL.createObjectURL(blob);const fileName=\"Crypto_Portfolio_\".concat(new Date().toISOString().split('T')[0],\".csv\");link.setAttribute('href',url);link.setAttribute('download',fileName);link.style.visibility='hidden';document.body.appendChild(link);link.click();document.body.removeChild(link);alert('✅ Export CSV สำเร็จ!');}catch(error){console.error('Export CSV Error:',error);alert('❌ เกิดข้อผิดพลาดในการ Export CSV');}};","map":{"version":3,"names":["XLSX","exportToExcel","trades","data","map","trade","id","date","type","pair","price","amount","totalValue","fee","profitLoss","status","cashBalance","capitalBalance","profitBalance","portfolioValue","note","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","wscols","wch","fileName","concat","Date","toISOString","split","writeFile","alert","error","console","exportToCSV","headers","rows","csvContent","join","row","cell","blob","Blob","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild"],"sources":["/Users/armsmacpro/Desktop/crypto-portfolio/src/utils/exportUtils.js"],"sourcesContent":["import * as XLSX from 'xlsx';\r\n\r\nexport const exportToExcel = (trades) => {\r\n  try {\r\n    const data = trades.map(trade => ({\r\n      'ID': trade.id,\r\n      'วันที่': trade.date,\r\n      'ประเภท': trade.type,\r\n      'คู่เทรด': trade.pair,\r\n      'ราคา': trade.price,\r\n      'จำนวน': trade.amount,\r\n      'มูลค่ารวม': trade.totalValue,\r\n      'ค่าธรรมเนียม': trade.fee,\r\n      'กำไร/ขาดทุน': trade.profitLoss,\r\n      'สถานะ': trade.status,\r\n      'เงินสดคงเหลือ': trade.cashBalance,\r\n      'เงินทุนสุทธิ': trade.capitalBalance,\r\n      'กำไรสะสม': trade.profitBalance,\r\n      'มูลค่าพอร์ต': trade.portfolioValue,\r\n      'หมายเหตุ': trade.note\r\n    }));\r\n\r\n    const ws = XLSX.utils.json_to_sheet(data);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, 'Trade Ledger');\r\n\r\n    const wscols = [\r\n      { wch: 5 }, { wch: 12 }, { wch: 10 }, { wch: 12 }, { wch: 12 },\r\n      { wch: 15 }, { wch: 15 }, { wch: 12 }, { wch: 15 }, { wch: 10 },\r\n      { wch: 15 }, { wch: 15 }, { wch: 15 }, { wch: 15 }, { wch: 20 }\r\n    ];\r\n    ws['!cols'] = wscols;\r\n\r\n    const fileName = `Crypto_Portfolio_${new Date().toISOString().split('T')[0]}.xlsx`;\r\n    XLSX.writeFile(wb, fileName);\r\n\r\n    alert('✅ Export Excel สำเร็จ!');\r\n  } catch (error) {\r\n    console.error('Export Excel Error:', error);\r\n    alert('❌ เกิดข้อผิดพลาดในการ Export Excel');\r\n  }\r\n};\r\n\r\nexport const exportToCSV = (trades) => {\r\n  try {\r\n    const headers = [\r\n      'ID', 'วันที่', 'ประเภท', 'คู่เทรด', 'ราคา', 'จำนวน',\r\n      'มูลค่ารวม', 'ค่าธรรมเนียม', 'กำไร/ขาดทุน', 'สถานะ',\r\n      'เงินสดคงเหลือ', 'เงินทุนสุทธิ', 'กำไรสะสม', 'มูลค่าพอร์ต', 'หมายเหตุ'\r\n    ];\r\n\r\n    const rows = trades.map(trade => [\r\n      trade.id, trade.date, trade.type, trade.pair, trade.price, trade.amount,\r\n      trade.totalValue, trade.fee, trade.profitLoss, trade.status,\r\n      trade.cashBalance, trade.capitalBalance, trade.profitBalance,\r\n      trade.portfolioValue, trade.note\r\n    ]);\r\n\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob(['\\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const link = document.createElement('a');\r\n    const url = URL.createObjectURL(blob);\r\n    const fileName = `Crypto_Portfolio_${new Date().toISOString().split('T')[0]}.csv`;\r\n\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', fileName);\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n\r\n    alert('✅ Export CSV สำเร็จ!');\r\n  } catch (error) {\r\n    console.error('Export CSV Error:', error);\r\n    alert('❌ เกิดข้อผิดพลาดในการ Export CSV');\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
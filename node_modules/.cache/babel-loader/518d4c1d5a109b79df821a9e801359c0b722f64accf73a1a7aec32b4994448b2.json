{"ast":null,"code":"import * as XLSX from 'xlsx';\nexport const exportToExcel = trades => {\n  try {\n    const data = trades.map(trade => ({\n      'ID': trade.id,\n      'วันที่': trade.date,\n      'ประเภท': trade.type,\n      'คู่เทรด': trade.pair,\n      'ราคา': trade.price,\n      'จำนวน': trade.amount,\n      'มูลค่ารวม': trade.totalValue,\n      'ค่าธรรมเนียม': trade.fee,\n      'กำไร/ขาดทุน': trade.profitLoss,\n      'สถานะ': trade.status,\n      'เงินสดคงเหลือ': trade.cashBalance,\n      'เงินทุนสุทธิ': trade.capitalBalance,\n      'กำไรสะสม': trade.profitBalance,\n      'มูลค่าพอร์ต': trade.portfolioValue,\n      'หมายเหตุ': trade.note\n    }));\n    const ws = XLSX.utils.json_to_sheet(data);\n    const wb = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wb, ws, 'Trade Ledger');\n    const wscols = [{\n      wch: 5\n    }, {\n      wch: 12\n    }, {\n      wch: 10\n    }, {\n      wch: 12\n    }, {\n      wch: 12\n    }, {\n      wch: 15\n    }, {\n      wch: 15\n    }, {\n      wch: 12\n    }, {\n      wch: 15\n    }, {\n      wch: 10\n    }, {\n      wch: 15\n    }, {\n      wch: 15\n    }, {\n      wch: 15\n    }, {\n      wch: 15\n    }, {\n      wch: 20\n    }];\n    ws['!cols'] = wscols;\n    const fileName = `Crypto_Portfolio_${new Date().toISOString().split('T')[0]}.xlsx`;\n    XLSX.writeFile(wb, fileName);\n    alert('✅ Export Excel สำเร็จ!');\n  } catch (error) {\n    console.error('Export Excel Error:', error);\n    alert('❌ เกิดข้อผิดพลาดในการ Export Excel');\n  }\n};\nexport const exportToCSV = trades => {\n  try {\n    const headers = ['ID', 'วันที่', 'ประเภท', 'คู่เทรด', 'ราคา', 'จำนวน', 'มูลค่ารวม', 'ค่าธรรมเนียม', 'กำไร/ขาดทุน', 'สถานะ', 'เงินสดคงเหลือ', 'เงินทุนสุทธิ', 'กำไรสะสม', 'มูลค่าพอร์ต', 'หมายเหตุ'];\n    const rows = trades.map(trade => [trade.id, trade.date, trade.type, trade.pair, trade.price, trade.amount, trade.totalValue, trade.fee, trade.profitLoss, trade.status, trade.cashBalance, trade.capitalBalance, trade.profitBalance, trade.portfolioValue, trade.note]);\n    const csvContent = [headers.join(','), ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))].join('\\n');\n    const blob = new Blob(['\\uFEFF' + csvContent], {\n      type: 'text/csv;charset=utf-8;'\n    });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n    const fileName = `Crypto_Portfolio_${new Date().toISOString().split('T')[0]}.csv`;\n    link.setAttribute('href', url);\n    link.setAttribute('download', fileName);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    alert('✅ Export CSV สำเร็จ!');\n  } catch (error) {\n    console.error('Export CSV Error:', error);\n    alert('❌ เกิดข้อผิดพลาดในการ Export CSV');\n  }\n};","map":{"version":3,"names":["XLSX","exportToExcel","trades","data","map","trade","id","date","type","pair","price","amount","totalValue","fee","profitLoss","status","cashBalance","capitalBalance","profitBalance","portfolioValue","note","ws","utils","json_to_sheet","wb","book_new","book_append_sheet","wscols","wch","fileName","Date","toISOString","split","writeFile","alert","error","console","exportToCSV","headers","rows","csvContent","join","row","cell","blob","Blob","link","document","createElement","url","URL","createObjectURL","setAttribute","style","visibility","body","appendChild","click","removeChild"],"sources":["/Users/armsmacpro/Desktop/crypto-portfolio/src/utils/exportUtils.js"],"sourcesContent":["import * as XLSX from 'xlsx';\r\n\r\nexport const exportToExcel = (trades) => {\r\n  try {\r\n    const data = trades.map(trade => ({\r\n      'ID': trade.id,\r\n      'วันที่': trade.date,\r\n      'ประเภท': trade.type,\r\n      'คู่เทรด': trade.pair,\r\n      'ราคา': trade.price,\r\n      'จำนวน': trade.amount,\r\n      'มูลค่ารวม': trade.totalValue,\r\n      'ค่าธรรมเนียม': trade.fee,\r\n      'กำไร/ขาดทุน': trade.profitLoss,\r\n      'สถานะ': trade.status,\r\n      'เงินสดคงเหลือ': trade.cashBalance,\r\n      'เงินทุนสุทธิ': trade.capitalBalance,\r\n      'กำไรสะสม': trade.profitBalance,\r\n      'มูลค่าพอร์ต': trade.portfolioValue,\r\n      'หมายเหตุ': trade.note\r\n    }));\r\n\r\n    const ws = XLSX.utils.json_to_sheet(data);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, 'Trade Ledger');\r\n\r\n    const wscols = [\r\n      { wch: 5 }, { wch: 12 }, { wch: 10 }, { wch: 12 }, { wch: 12 },\r\n      { wch: 15 }, { wch: 15 }, { wch: 12 }, { wch: 15 }, { wch: 10 },\r\n      { wch: 15 }, { wch: 15 }, { wch: 15 }, { wch: 15 }, { wch: 20 }\r\n    ];\r\n    ws['!cols'] = wscols;\r\n\r\n    const fileName = `Crypto_Portfolio_${new Date().toISOString().split('T')[0]}.xlsx`;\r\n    XLSX.writeFile(wb, fileName);\r\n\r\n    alert('✅ Export Excel สำเร็จ!');\r\n  } catch (error) {\r\n    console.error('Export Excel Error:', error);\r\n    alert('❌ เกิดข้อผิดพลาดในการ Export Excel');\r\n  }\r\n};\r\n\r\nexport const exportToCSV = (trades) => {\r\n  try {\r\n    const headers = [\r\n      'ID', 'วันที่', 'ประเภท', 'คู่เทรด', 'ราคา', 'จำนวน',\r\n      'มูลค่ารวม', 'ค่าธรรมเนียม', 'กำไร/ขาดทุน', 'สถานะ',\r\n      'เงินสดคงเหลือ', 'เงินทุนสุทธิ', 'กำไรสะสม', 'มูลค่าพอร์ต', 'หมายเหตุ'\r\n    ];\r\n\r\n    const rows = trades.map(trade => [\r\n      trade.id, trade.date, trade.type, trade.pair, trade.price, trade.amount,\r\n      trade.totalValue, trade.fee, trade.profitLoss, trade.status,\r\n      trade.cashBalance, trade.capitalBalance, trade.profitBalance,\r\n      trade.portfolioValue, trade.note\r\n    ]);\r\n\r\n    const csvContent = [\r\n      headers.join(','),\r\n      ...rows.map(row => row.map(cell => `\"${cell}\"`).join(','))\r\n    ].join('\\n');\r\n\r\n    const blob = new Blob(['\\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });\r\n    const link = document.createElement('a');\r\n    const url = URL.createObjectURL(blob);\r\n    const fileName = `Crypto_Portfolio_${new Date().toISOString().split('T')[0]}.csv`;\r\n\r\n    link.setAttribute('href', url);\r\n    link.setAttribute('download', fileName);\r\n    link.style.visibility = 'hidden';\r\n    document.body.appendChild(link);\r\n    link.click();\r\n    document.body.removeChild(link);\r\n\r\n    alert('✅ Export CSV สำเร็จ!');\r\n  } catch (error) {\r\n    console.error('Export CSV Error:', error);\r\n    alert('❌ เกิดข้อผิดพลาดในการ Export CSV');\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}